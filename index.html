<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skip Calculator 3.0 - Retro Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap');
        
        :root {
            --neon-pink: #ff0080;
            --neon-cyan: #00ffff;
            --neon-yellow: #ffff00;
            --neon-green: #39ff14;
            --retro-purple: #8a2be2;
            --dark-bg: #0a0a0a;
            --grid-color: #ff0080;
        }
        
        body {
            font-family: 'Space Mono', monospace;
            background: linear-gradient(45deg, #0a0a0a 0%, #1a0033 50%, #330066 100%);
            position: relative;
            overflow-x: hidden;
            color: #00ffff;
        }
        
        /* Retro Grid Background */
        .retro-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.3;
            z-index: -2;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 40px 40px;
            animation: gridGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes gridGlow {
            0% { opacity: 0.2; }
            100% { opacity: 0.4; }
        }
        
        /* Neon Scan Lines */
        .scan-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 255, 255, 0.03) 2px,
                rgba(0, 255, 255, 0.03) 4px
            );
            animation: scanMove 0.1s linear infinite;
        }
        
        @keyframes scanMove {
            0% { transform: translateY(0); }
            100% { transform: translateY(4px); }
        }
        
        /* Floating Geometric Shapes */
        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .shape {
            position: absolute;
            border: 2px solid;
            animation: floatShape 8s linear infinite;
        }
        
        .triangle {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 25px solid var(--neon-pink);
            filter: drop-shadow(0 0 10px var(--neon-pink));
        }
        
        .circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border-color: var(--neon-cyan);
            filter: drop-shadow(0 0 10px var(--neon-cyan));
        }
        
        .square {
            width: 25px;
            height: 25px;
            border-color: var(--neon-yellow);
            filter: drop-shadow(0 0 10px var(--neon-yellow));
            transform: rotate(45deg);
        }
        
        @keyframes floatShape {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) translateX(50px); opacity: 0; }
        }
        
        /* Retro Cards */
        .retro-card {
            background: linear-gradient(145deg, rgba(10, 10, 10, 0.9), rgba(51, 0, 102, 0.3));
            border: 2px solid var(--neon-cyan);
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.3),
                inset 0 0 20px rgba(255, 0, 128, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .retro-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.5),
                0 10px 30px rgba(255, 0, 128, 0.3),
                inset 0 0 20px rgba(255, 0, 128, 0.2);
            border-color: var(--neon-pink);
        }
        
        /* Neon Text Effects */
        .neon-title {
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            background: linear-gradient(45deg, var(--neon-pink), var(--neon-cyan), var(--neon-yellow));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: neonGradient 2s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(255, 0, 128, 0.5);
        }
        
        @keyframes neonGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .neon-text {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
            font-family: 'Orbitron', monospace;
            font-weight: 700;
        }
        
        .neon-pink-text {
            color: var(--neon-pink);
            text-shadow: 0 0 10px var(--neon-pink);
        }
        
        .neon-yellow-text {
            color: var(--neon-yellow);
            text-shadow: 0 0 10px var(--neon-yellow);
        }
        
        .neon-green-text {
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green);
        }
        
        /* Retro Buttons */
        .retro-button {
            position: relative;
            overflow: hidden;
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.2), rgba(138, 43, 226, 0.2));
            border: 2px solid var(--neon-pink);
            color: var(--neon-pink);
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.3);
            cursor: pointer;
        }
        
        .retro-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .retro-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(255, 0, 128, 0.6);
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            background: linear-gradient(45deg, rgba(0, 255, 255, 0.2), rgba(138, 43, 226, 0.2));
        }
        
        .retro-button:hover::before {
            left: 100%;
        }
        
        .retro-button:active {
            transform: translateY(0px);
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.8);
        }
        
        /* Retro Input Fields */
        .retro-input {
            background: rgba(10, 10, 10, 0.8);
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
            font-family: 'Space Mono', monospace;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 10px rgba(0, 255, 255, 0.2);
        }
        
        .retro-input:focus {
            background: rgba(10, 10, 10, 0.9);
            border-color: var(--neon-pink);
            color: var(--neon-pink);
            box-shadow: 
                0 0 15px rgba(255, 0, 128, 0.4),
                inset 0 0 10px rgba(255, 0, 128, 0.2);
            outline: none;
        }
        
        .retro-input::placeholder {
            color: rgba(0, 255, 255, 0.5);
        }
        
        /* Progress Ring */
        .retro-progress {
            filter: drop-shadow(0 0 10px var(--neon-cyan));
        }
        
        /* Calendar Styles */
        .retro-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 3px;
        }
        
        .retro-day {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 255, 255, 0.1);
            color: var(--neon-cyan);
            border: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
        }
        
        .retro-day.missed {
            background: rgba(255, 0, 128, 0.3);
            color: var(--neon-pink);
            border-color: var(--neon-pink);
            box-shadow: 0 0 10px rgba(255, 0, 128, 0.5);
        }
        
        .retro-day.missed::after {
            content: attr(data-hours);
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--neon-yellow);
            color: #000;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 8px var(--neon-yellow);
        }
        
        /* Attendance Bar */
        .retro-bar {
            background: linear-gradient(90deg, var(--neon-pink), var(--neon-yellow), var(--neon-green));
            height: 20px;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }
        
        .retro-marker {
            position: absolute;
            top: -6px;
            width: 32px;
            height: 32px;
            background: radial-gradient(circle, var(--neon-cyan), var(--dark-bg));
            border-radius: 50%;
            border: 3px solid var(--neon-yellow);
            transform: translateX(-50%);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
            animation: markerPulse 2s ease-in-out infinite;
        }
        
        @keyframes markerPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 255, 0.8); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 255, 1); }
        }
        
        /* Stats Cards */
        .stat-card {
            background: linear-gradient(135deg, rgba(255, 0, 128, 0.1), rgba(0, 255, 255, 0.1));
            border: 2px solid;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .stat-card.emerald { border-color: var(--neon-green); }
        .stat-card.red { border-color: var(--neon-pink); }
        .stat-card.amber { border-color: var(--neon-yellow); }
        .stat-card.purple { border-color: var(--retro-purple); }
        
        .stat-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.4);
        }
        
        /* Banner Styles */
        .retro-banner {
            background: linear-gradient(45deg, rgba(57, 255, 20, 0.1), rgba(0, 255, 255, 0.1));
            border: 2px solid var(--neon-green);
            box-shadow: 0 0 20px rgba(57, 255, 20, 0.3);
        }
        
        /* Glitch Effect for Title */
        .glitch {
            position: relative;
        }
        
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .glitch::before {
            animation: glitch-1 0.5s infinite linear alternate-reverse;
            color: var(--neon-pink);
            z-index: -1;
        }
        
        .glitch::after {
            animation: glitch-2 0.5s infinite linear alternate-reverse;
            color: var(--neon-cyan);
            z-index: -2;
        }
        
        @keyframes glitch-1 {
            0% { transform: translateX(0); }
            20% { transform: translateX(-2px); }
            40% { transform: translateX(-2px); }
            60% { transform: translateX(2px); }
            80% { transform: translateX(2px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes glitch-2 {
            0% { transform: translateX(0); }
            20% { transform: translateX(2px); }
            40% { transform: translateX(2px); }
            60% { transform: translateX(-2px); }
            80% { transform: translateX(-2px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Retro Background Elements -->
    <div class="retro-grid"></div>
    <div class="scan-lines"></div>
    
    <div class="floating-shapes">
        <div class="shape triangle" style="top: 20%; left: 10%; animation-delay: 0s;"></div>
        <div class="shape circle" style="top: 40%; left: 5%; animation-delay: -2s;"></div>
        <div class="shape square" style="top: 60%; left: 15%; animation-delay: -4s;"></div>
        <div class="shape triangle" style="top: 30%; left: 85%; animation-delay: -6s;"></div>
        <div class="shape circle" style="top: 70%; left: 90%; animation-delay: -8s;"></div>
        <div class="shape square" style="top: 10%; left: 80%; animation-delay: -10s;"></div>
    </div>

    <div class="max-w-6xl mx-auto p-4 relative z-10">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl md:text-7xl font-black mb-4 neon-title glitch" data-text="SKIP CALC 80">
                SKIP CALC 80
            </h1>
            <p class="text-xl neon-text mb-2 font-bold tracking-wide">◊ RETRO ATTENDANCE TRACKER ◊</p>
            <p class="text-sm text-gray-400 font-mono">SYSTEM.INITIALIZE(); // Track smartly, skip safely 🎯</p>
            
            <!-- Motivational Banner -->
            <div class="retro-banner retro-card mt-6 p-4 rounded-xl">
                <div class="flex items-center justify-center gap-3 text-center">
                    <span class="text-2xl neon-green-text">▲</span>
                    <div>
                        <h3 class="font-bold neon-green-text text-lg font-mono tracking-wide">TAKING.BREAKS = NORMAL.OPERATION</h3>
                        <p class="text-sm text-gray-300 font-mono">Mental.health && family.time && personal.days = IMPORTANT; <br>Our math.logic helps you skip() while maintaining 75%+ status. Life.happens() && that.isOK(); 💚</p>
                    </div>
                    <span class="text-2xl neon-green-text">◆</span>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="grid lg:grid-cols-2 gap-6 mb-6">
            
            <!-- Left: Current Status & Log Leave -->
            <div class="space-y-6">
                <!-- Current Attendance Status -->
                <div class="retro-card rounded-xl p-6">
                    <h2 class="text-2xl font-bold mb-6 neon-text">📊 SYSTEM.STATUS</h2>
                    
                    <!-- Circular Progress -->
                    <div class="flex items-center justify-center mb-6">
                        <div class="relative">
                            <svg class="retro-progress w-32 h-32 transform -rotate-90" width="128" height="128">
                                <circle class="text-gray-600" stroke-width="8" stroke="currentColor" fill="transparent" r="56" cx="64" cy="64"/>
                                <circle id="progressCircle" class="text-cyan-400 transition-all duration-500" stroke-width="8" stroke-dasharray="351.86" stroke-dashoffset="0" stroke-linecap="round" stroke="currentColor" fill="transparent" r="56" cx="64" cy="64"/>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="text-center">
                                    <div id="currentPercentage" class="text-2xl font-black neon-text font-mono">100%</div>
                                    <div class="text-xs text-gray-400 font-mono">ATTEND.RATE</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Grid -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="stat-card emerald text-center p-3">
                            <div id="hoursAttended" class="text-2xl font-black neon-green-text font-mono">16</div>
                            <div class="text-xs text-gray-400 font-mono">HRS.ATTENDED</div>
                        </div>
                        <div class="stat-card red text-center p-3">
                            <div id="hoursMissed" class="text-2xl font-black neon-pink-text font-mono">0</div>
                            <div class="text-xs text-gray-400 font-mono">HRS.MISSED</div>
                        </div>
                        <div class="stat-card amber text-center p-3">
                            <div id="safeHours" class="text-2xl font-black neon-yellow-text font-mono">4</div>
                            <div class="text-xs text-gray-400 font-mono">SAFE.SKIP</div>
                        </div>
                        <div class="stat-card purple text-center p-3">
                            <div id="minRequired" class="text-2xl font-black" style="color: var(--retro-purple); text-shadow: 0 0 10px var(--retro-purple);">12</div>
                            <div class="text-xs text-gray-400 font-mono">MIN.REQ</div>
                        </div>
                    </div>

                    <!-- Attendance Bar -->
                    <div class="mt-6">
                        <div class="retro-bar">
                            <div id="attendanceMarker" class="retro-marker"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-400 mt-2 font-mono">
                            <span>0%</span>
                            <span class="neon-yellow-text font-bold">75% MIN.THRESH</span>
                            <span>100%</span>
                        </div>
                    </div>
                </div>

                <!-- Log Leave -->
                <div class="retro-card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-4 neon-pink-text">🚫 LOG.MISSED_HRS</h3>
                    <div class="space-y-4">
                        <div class="flex gap-3">
                            <input type="date" id="missedDate" class="flex-1 p-3 rounded-lg retro-input font-mono">
                            <input type="number" id="missedHours" placeholder="HRS" min="0.5" max="8" step="0.5" class="w-24 p-3 rounded-lg retro-input text-center font-mono">
                            <button onclick="logMissedHours()" class="px-6 py-3 retro-button rounded-lg">LOG</button>
                        </div>
                        <div class="text-sm text-gray-400 font-mono">
                            INPUT: date && hours_missed; <br>
                            CALC: attendance = (hrs_attended / total_hrs) * 100;
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: AI Recommendation & Excuse Generator -->
            <div class="space-y-6">
                <!-- AI Recommendation -->
                <div class="retro-card rounded-xl p-6 text-center">
                    <h3 class="text-xl font-bold mb-4 neon-text">🤖 AI.VERDICT</h3>
                    <div id="skipEmoji" class="text-5xl mb-4">😎</div>
                    <div id="skipRecommendation" class="font-bold text-2xl mb-3 neon-green-text font-mono">
                        SAFE.TO.SKIP
                    </div>
                    <div id="skipReason" class="text-sm text-gray-300 mb-4 font-mono">
                        Buffer.sufficient() == true; Skip.safely();
                    </div>
                    <div id="skipDetails" class="text-xs text-gray-400 bg-cyan-900/20 p-3 rounded-lg border border-cyan-500/30 font-mono">
                        Available.skip_hrs = 4; Maintain.75percent = true;
                    </div>
                </div>

                <!-- Excuse Generator -->
                <div class="retro-card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-4 neon-pink-text">🎭 EXCUSE.GEN</h3>
                    <div class="space-y-4">
                        <div id="generatedExcuse" class="bg-gradient-to-r from-pink-900/20 to-purple-900/20 p-4 rounded-lg border border-pink-500/30 min-h-[80px] flex items-center justify-center text-center">
                            <div class="text-gray-400 italic font-mono">EXECUTE generate.excuse() FOR creative.skip.reasons(); 🎲</div>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="generateExcuse()" class="p-3 retro-button rounded-lg text-sm">
                                🎲 NEW.EXCUSE
                            </button>
                            <button onclick="generateSillyStats()" class="p-3 retro-button rounded-lg text-sm" style="border-color: var(--neon-yellow); color: var(--neon-yellow);">
                                📊 SILLY.STATS
                            </button>
                        </div>
                        <div class="text-xs text-gray-500 text-center font-mono">
                            // For entertainment.only; Use.responsibly();
                        </div>
                    </div>
                </div>

                <!-- Mini Calendar -->
                <div class="retro-card rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-lg font-bold text-gray-300 font-mono">📅 MISSED.DAYS</h4>
                        <div class="flex gap-1">
                            <button onclick="changeMonth(-1)" class="p-1 retro-button text-xs rounded">←</button>
                            <span id="calendarMonth" class="px-2 py-1 font-bold text-gray-300 text-sm font-mono"></span>
                            <button onclick="changeMonth(1)" class="p-1 retro-button text-xs rounded">→</button>
                        </div>
                    </div>
                    <div class="retro-calendar mb-2">
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">S</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">M</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">T</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">W</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">T</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">F</div>
                        <div class="text-center text-xs text-gray-500 font-bold py-1 font-mono">S</div>
                    </div>
                    <div id="miniCalendarGrid" class="retro-calendar mb-3">
                        <!-- Populated by JS -->
                    </div>
                    <div class="text-center text-xs text-gray-500 font-mono">
                        RED.days = missed; NUMBERS = hrs.missed;
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Logs & Quick Actions -->
        <div class="grid lg:grid-cols-2 gap-6">
            <!-- Recent Missed Hours Log -->
            <div class="retro-card rounded-xl p-6">
                <h3 class="text-xl font-bold mb-4" style="color: var(--retro-purple); text-shadow: 0 0 10px var(--retro-purple);">📝 RECENT.LOGS</h3>
                <div id="recentLogs" class="space-y-2 max-h-48 overflow-y-auto">
                    <div class="text-sm text-gray-500 text-center py-4 font-mono">
                        LOG.STATUS: empty; // Good.job() executed! 🎉
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="retro-card rounded-xl p-6">
                <h3 class="text-xl font-bold mb-4 neon-text">⚡ QUICK.ACTIONS</h3>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="simulateSkip()" class="p-3 retro-button rounded-lg text-sm" style="border-color: var(--neon-yellow); color: var(--neon-yellow);">
                        🎲 SIMULATE
                    </button>
                    <button onclick="resetMonth()" class="p-3 retro-button rounded-lg text-sm" style="border-color: var(--neon-green); color: var(--neon-green);">
                        🔄 RESET
                    </button>
                    <button onclick="deleteLastLog()" class="p-3 retro-button rounded-lg text-sm">
                        🗑️ UNDO.LAST
                    </button>
                    <button onclick="generateExcuse()" class="p-3 retro-button rounded-lg text-sm" style="border-color: var(--neon-pink); color: var(--neon-pink);">
                        🎭 EXCUSE.ME
                    </button>
                </div>
                
                <!-- Subject Selector -->
                <div class="mt-4">
                    <label class="block text-xs font-semibold mb-1 text-gray-400 font-mono">CURRENT.SUBJECT:</label>
                    <select id="subjectSelect" onchange="switchSubject()" class="w-full p-2 rounded-lg retro-input font-mono text-sm">
                        <option value="0">DATA.STRUCTURES (16h/month)</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Retro-themed data structure
        let subjects = [
            {
                name: "Data Structures",
                totalHours: 16,
                missedHours: 0,
                missedDays: {}
            }
        ];
        
        let activeSubjectIndex = 0;
        let currentViewMonth = new Date().getMonth();
        let currentViewYear = new Date().getFullYear();

        // Initialize app
        function initializeApp() {
            console.log('SYSTEM.BOOT: Initializing Skip Calculator 3.0...');
            setTodayDate();
            updateCalendar();
            calculateAttendance();
            updateRecommendation();
            updateRecentLogs();
            showRetroNotification('SYSTEM.ONLINE: Skip Calculator 3.0 initialized successfully!', 'success');
        }

        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('missedDate').value = today;
        }

        // Proper attendance calculation logic
        function calculateAttendance() {
            const subject = subjects[activeSubjectIndex];
            const totalHours = subject.totalHours;
            const missedHours = subject.missedHours;
            
            const hoursAttended = totalHours - missedHours;
            const currentPercentage = Math.max(0, (hoursAttended / totalHours) * 100);
            const minHoursFor75 = Math.ceil(totalHours * 0.75);
            const safeHoursToSkip = Math.max(0, hoursAttended - minHoursFor75);

            // Update UI
            document.getElementById('currentPercentage').textContent = `${currentPercentage.toFixed(1)}%`;
            document.getElementById('hoursAttended').textContent = hoursAttended.toFixed(1);
            document.getElementById('hoursMissed').textContent = missedHours.toFixed(1);
            document.getElementById('safeHours').textContent = safeHoursToSkip.toFixed(1);
            document.getElementById('minRequired').textContent = minHoursFor75;

            // Update circular progress
            const circumference = 2 * Math.PI * 56;
            const offset = circumference - (currentPercentage / 100) * circumference;
            const progressCircle = document.getElementById('progressCircle');
            progressCircle.style.strokeDashoffset = offset;
            
            // Retro color scheme
            if (currentPercentage >= 85) {
                progressCircle.style.stroke = 'var(--neon-green)';
                progressCircle.style.filter = 'drop-shadow(0 0 10px var(--neon-green))';
            } else if (currentPercentage >= 75) {
                progressCircle.style.stroke = 'var(--neon-yellow)';
                progressCircle.style.filter = 'drop-shadow(0 0 10px var(--neon-yellow))';
            } else {
                progressCircle.style.stroke = 'var(--neon-pink)';
                progressCircle.style.filter = 'drop-shadow(0 0 10px var(--neon-pink))';
            }

            // Update attendance bar
            const marker = document.getElementById('attendanceMarker');
            const position = Math.max(0, Math.min(100, currentPercentage));
            marker.style.left = `${position}%`;

            return { currentPercentage, safeHoursToSkip, hoursAttended, missedHours, minHoursFor75 };
        }

        function logMissedHours() {
            const date = document.getElementById('missedDate').value;
            const hours = parseFloat(document.getElementById('missedHours').value);
            
            if (!date || !hours || hours <= 0) {
                showRetroNotification('ERROR: Invalid.input(); Please.enter.valid.data();', 'error');
                return;
            }

            const subject = subjects[activeSubjectIndex];
            subject.missedDays[date] = hours;
            subject.missedHours = Object.values(subject.missedDays).reduce((sum, h) => sum + h, 0);
            
            document.getElementById('missedHours').value = '';
            
            updateCalendar();
            calculateAttendance();
            updateRecommendation();
            updateRecentLogs();
            
            showRetroNotification(`SUCCESS: Logged.${hours}h.on.${date}; System.updated();`, 'success');
        }

        function updateRecommendation() {
            const stats = calculateAttendance();
            
            const emojiElement = document.getElementById('skipEmoji');
            const recommendationElement = document.getElementById('skipRecommendation');
            const reasonElement = document.getElementById('skipReason');
            const detailsElement = document.getElementById('skipDetails');

            if (stats.currentPercentage < 75) {
                emojiElement.textContent = '🚨';
                recommendationElement.textContent = 'DANGER.ZONE';
                recommendationElement.className = 'font-bold text-2xl mb-3 neon-pink-text font-mono';
                reasonElement.textContent = 'Threshold.breached(); Attend.immediately();';
                detailsElement.textContent = `REQUIRED: attend.${(stats.minHoursFor75 - stats.hoursAttended).toFixed(1)}.more.hrs();`;
            } else if (stats.currentPercentage < 80) {
                emojiElement.textContent = '⚠️';
                recommendationElement.textContent = 'RISKY.ZONE';
                recommendationElement.className = 'font-bold text-2xl mb-3 neon-yellow-text font-mono';
                reasonElement.textContent = 'Warning.proximity(); Skip.with.caution();';
                detailsElement.textContent = `Available.skip = ${stats.safeHoursToSkip.toFixed(1)}.hrs;`;
            } else if (stats.safeHoursToSkip >= 3) {
                emojiElement.textContent = '😎';
                recommendationElement.textContent = 'SAFE.TO.SKIP';
                recommendationElement.className = 'font-bold text-2xl mb-3 neon-green-text font-mono';
                reasonElement.textContent = 'Buffer.sufficient(); Execute.break.protocol();';
                detailsElement.textContent = `Safe.skip = ${stats.safeHoursToSkip.toFixed(1)}.hrs; Maintain.75percent();`;
            } else {
                emojiElement.textContent = '🤓';
                recommendationElement.textContent = 'MODERATE.RISK';
                recommendationElement.className = 'font-bold text-2xl mb-3 neon-text font-mono';
                reasonElement.textContent = 'Limited.buffer(); Choose.wisely();';
                detailsElement.textContent = `Remaining.safe = ${stats.safeHoursToSkip.toFixed(1)}.hrs;`;
            }
        }

        function updateCalendar() {
            const monthNames = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN',
                              'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
            
            document.getElementById('calendarMonth').textContent = 
                `${monthNames[currentViewMonth]}.${currentViewYear}`;

            const grid = document.getElementById('miniCalendarGrid');
            grid.innerHTML = '';

            const daysInMonth = new Date(currentViewYear, currentViewMonth + 1, 0).getDate();
            const firstDay = new Date(currentViewYear, currentViewMonth, 1).getDay();
            const subject = subjects[activeSubjectIndex];

            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'retro-day opacity-30';
                grid.appendChild(emptyCell);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${currentViewYear}-${String(currentViewMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const cell = document.createElement('div');
                cell.className = 'retro-day';
                cell.textContent = day;

                if (subject.missedDays[dateStr]) {
                    const hoursMissed = subject.missedDays[dateStr];
                    cell.classList.add('missed');
                    cell.setAttribute('data-hours', hoursMissed);
                    cell.title = `${dateStr}: ${hoursMissed}h.missed;`;
                }

                grid.appendChild(cell);
            }
        }

        function changeMonth(direction) {
            currentViewMonth += direction;
            if (currentViewMonth > 11) {
                currentViewMonth = 0;
                currentViewYear++;
            } else if (currentViewMonth < 0) {
                currentViewMonth = 11;
                currentViewYear--;
            }
            updateCalendar();
        }

        function updateRecentLogs() {
            const subject = subjects[activeSubjectIndex];
            const logsContainer = document.getElementById('recentLogs');
            
            const logs = Object.entries(subject.missedDays)
                .sort(([a], [b]) => new Date(b) - new Date(a))
                .slice(0, 8);

            if (logs.length === 0) {
                logsContainer.innerHTML = `
                    <div class="text-sm text-gray-500 text-center py-4 font-mono">
                        LOG.STATUS: empty; // Good.job() executed! 🎉
                    </div>
                `;
                return;
            }

            logsContainer.innerHTML = logs.map(([date, hours]) => {
                const dateObj = new Date(date);
                const formattedDate = dateObj.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                }).toUpperCase();
                
                const percentageLost = (hours / subjects[activeSubjectIndex].totalHours * 100).toFixed(1);
                
                return `
                    <div class="flex justify-between items-center p-2 bg-pink-900/20 rounded-lg border border-pink-500/30">
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full" style="background: var(--neon-pink); box-shadow: 0 0 5px var(--neon-pink);"></div>
                            <span class="text-sm font-medium text-gray-300 font-mono">${formattedDate}</span>
                        </div>
                        <div class="text-sm font-bold neon-pink-text font-mono">${hours}H (-${percentageLost}%)</div>
                    </div>
                `;
            }).join('');
        }

        function switchSubject() {
            activeSubjectIndex = parseInt(document.getElementById('subjectSelect').value);
            calculateAttendance();
            updateRecommendation();
            updateCalendar();
            updateRecentLogs();
        }

        // Quick Actions
        function simulateSkip() {
            const hours = parseFloat(prompt('SIMULATE.SKIP: Enter.hours.to.test();', '2'));
            if (!hours || hours <= 0 || isNaN(hours)) {
                showRetroNotification('ERROR: Invalid.simulation.input();', 'error');
                return;
            }

            const subject = subjects[activeSubjectIndex];
            const totalHours = subject.totalHours;
            const currentMissed = subject.missedHours;
            const newMissed = currentMissed + hours;
            
            const newAttended = totalHours - newMissed;
            const newPercentage = Math.max(0, (newAttended / totalHours) * 100);
            
            const status = newPercentage >= 75 ? '✅ SAFE.OPERATION' : '⚠️ RISKY.TERRITORY';
            const statusColor = newPercentage >= 75 ? 'success' : 'warning';
            
            showRetroNotification(
                `SIMULATION.RESULT: Skip.${hours}h → ${newPercentage.toFixed(1)}% ${status}`,
                statusColor
            );
        }

        function resetMonth() {
            if (!confirm('RESET.CONFIRM: Clear.all.missed.hours? Operation.irreversible();')) return;
            
            const subject = subjects[activeSubjectIndex];
            subject.missedHours = 0;
            subject.missedDays = {};
            
            calculateAttendance();
            updateRecommendation();
            updateCalendar();
            updateRecentLogs();
            
            showRetroNotification('SYSTEM.RESET: Fresh.start.initiated(); Attendance.100%;', 'success');
        }

        function deleteLastLog() {
            const subject = subjects[activeSubjectIndex];
            const logs = Object.entries(subject.missedDays)
                .sort(([a], [b]) => new Date(b) - new Date(a));
            
            if (logs.length === 0) {
                showRetroNotification('ERROR: No.logs.found(); Nothing.to.delete();', 'error');
                return;
            }

            const [dateToDelete, hoursToDelete] = logs[0];
            delete subject.missedDays[dateToDelete];
            subject.missedHours = Object.values(subject.missedDays).reduce((sum, h) => sum + h, 0);
            
            calculateAttendance();
            updateRecommendation();
            updateCalendar();
            updateRecentLogs();
            
            showRetroNotification(`DELETED: ${hoursToDelete}h.from.${dateToDelete}; System.updated();`, 'info');
        }

        // Retro Excuse Generator
        const retroExcuses = {
            health: [
                "SYSTEM.ERROR: Migraine.exe causing visual.display.malfunction 🤕",
                "FOOD.POISONING: Yesterday's cafeteria.meal corrupted digestive.system 🤢", 
                "HARDWARE.FAILURE: Ankle.joint twisted during morning.boot.sequence 🦶",
                "ALLERGIC.REACTION: Environmental.particles causing optical.sensor.errors 👀",
                "SCHEDULED.MAINTENANCE: Doctor.appointment rescheduled.to.current.timeframe 👨‍⚕️",
                "DENTAL.EMERGENCY: Wisdom.tooth.malfunction requires immediate.attention 🦷",
                "VIRUS.DETECTED: Cold.symptoms; Quarantine.protocol.activated 🤧"
            ],
            family: [
                "PRIORITY.INTERRUPT: Grandmother.visiting from remote.location.today.only 👵",
                "FAMILY.EMERGENCY: Cousin's wedding.preparations require.additional.processing.power 💒",
                "SYSTEM.ADMIN.REQUIRED: Parents need assistance with critical.paperwork.operations 📋",
                "BACKUP.CHILDCARE.NEEDED: Younger.sibling.system.down; Parents.currently.offline 👶",
                "DATA.MIGRATION: Family.relocating.furniture; All.hands.required 📦",
                "UNEXPECTED.CONNECTION: Relative.arrived.from.international.server 🛫"
            ],
            technical: [
                "NETWORK.DOWN: Internet.connection.offline since morning.boot 📱",
                "CRITICAL.ERROR: Laptop.crashed with all.assignments; Data.recovery.in.progress 💻",
                "POWER.FAILURE: Device.battery.depleted; Missed.all.group.communications 🔋",
                "INFRASTRUCTURE.OUTAGE: Area.power.grid.offline; Unable.to.charge.devices 🔌",
                "TRANSPORT.API.ERROR: No.buses.or.cabs.available.in.system 🚌"
            ],
            weather: [
                "WEATHER.HAZARD: Heavy.rain flooding primary.route.to.college 🌧️",
                "TEMPERATURE.WARNING: Extreme.heat causing system.overheating.symptoms ☀️",
                "STORM.ALERT: Thunderstorm making.travel.unsafe.for.organic.units ⛈️",
                "VISIBILITY.ERROR: Dense.fog causing navigation.and.safety.issues 🌫️"
            ]
        };

        const retroSillyStats = [
            "🌧️ WEATHER.API: too hot to be out / heavy rains and flooded roads",
            "💔 CRUSH.TRACKER: Crush is on a long leave",
            "👯 SQUAD.STATUS: 2/3 best friends decided not to come",
            "😤 PROFESSOR.ANALYSIS: The teacher i hate has a class today",
            "☕ CAFFEINE.SYSTEM: Campus.coffee.machine.offline; 0% energy.boost.available", 
            "🛏️ COMFORT.INDEX: Bed.running.at.98% coziness.optimization.today",
            "📱 SOCIAL.FEED: 156 new.Instagram.stories.requiring.immediate.processing",
            "🎮 GAMING.ALERT: New.update.deployed with 4.hours.of.fresh.content",
            "🍕 FOOD.COURT.STATUS: Pizza.day.active but only.during.your.class.time",
            "💤 SLEEP.DEBT: Current.deficit.2.5.hours from this.week's.operations",
            "🎵 PLAYLIST.REQUEST: 'Chill.Study' demanding.immediate.attention",
            "🌟 MAIN.CHARACTER.ENERGY: Today.registering.as.self-care.day.vibes",
            "📚 WEIGHT.SENSOR: Backpack.mass.increased.67% beyond.normal.parameters",
            "🚌 DRIVER.MOOD.ANALYSIS: College.bus.operator.showing.elevated.grumpiness",
            "🎯 FOCUS.METER: Concentration.levels.at.23% due.to.yesterday's.late.night.session"
        ];

        function generateExcuse() {
            const categories = Object.keys(retroExcuses);
            const randomCategory = categories[Math.floor(Math.random() * categories.length)];
            const excuses = retroExcuses[randomCategory];
            const randomExcuse = excuses[Math.floor(Math.random() * excuses.length)];
            
            const categoryIcons = {
                health: "🏥",
                family: "👨‍👩‍👧‍👦", 
                technical: "💻",
                weather: "🌤️"
            };

            document.getElementById('generatedExcuse').innerHTML = `
                <div>
                    <div class="text-lg mb-2 neon-pink-text font-mono">${categoryIcons[randomCategory]} ${randomCategory.toUpperCase()}.EXCUSE</div>
                    <div class="font-semibold text-gray-300 font-mono text-sm">"${randomExcuse}"</div>
                </div>
            `;

            showRetroNotification('EXCUSE.GENERATED: New.reason.compiled.successfully();', 'info');
        }

        function generateSillyStats() {
            const randomStat = retroSillyStats[Math.floor(Math.random() * retroSillyStats.length)];
            
            document.getElementById('generatedExcuse').innerHTML = `
                <div>
                    <div class="text-lg mb-2 neon-yellow-text font-mono">📊 DAILY.SILLY.STAT</div>
                    <div class="font-semibold text-gray-300 font-mono text-sm">${randomStat}</div>
                </div>
            `;

            showRetroNotification('SILLY.STAT.GENERATED: Universe.signals.decoded();', 'info');
        }

        // Retro Notification System
        function showRetroNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 font-mono text-sm border-2 transition-all duration-300 ${
                type === 'success' ? 'bg-green-900/80 text-green-400 border-green-400' :
                type === 'warning' ? 'bg-yellow-900/80 text-yellow-400 border-yellow-400' :
                type === 'error' ? 'bg-red-900/80 text-red-400 border-red-400' :
                'bg-cyan-900/80 text-cyan-400 border-cyan-400'
            }`;
            notification.style.boxShadow = `0 0 20px ${
                type === 'success' ? 'var(--neon-green)' :
                type === 'warning' ? 'var(--neon-yellow)' :
                type === 'error' ? 'var(--neon-pink)' :
                'var(--neon-cyan)'
            }`;
            
            notification.textContent = message;
            notification.style.transform = 'translateX(100%)';
            notification.style.opacity = '0';
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 100);
            
            // Animate out
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Initialize the retro system
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>